-- ***************************************************************************************************************************
-- *          CONSULTA DE TABLAS CATÁLOGO FEL-SV.                                                                            *
-- ***************************************************************************************************************************
SELECT C.* FROM CAT_000 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_001 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_002 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_003 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_004 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_005 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_006 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_007 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_008 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_009 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_010 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_011 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_012 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_013 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_014 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_015 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_016 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_017 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_018 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_019 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_020 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_021 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_022 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_023 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_024 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_025 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_026 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_027 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_028 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_029 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_030 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_031 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_032 C ORDER BY C.ID_CAT;
SELECT C.* FROM CAT_033 C ORDER BY C.ID_CAT;

-- ***************************************************************************************************************************
-- *          CONSULTA DE TABLAS EMISOR, SHAN, COMPAÑIA Y ESTABLECIMIENTO FEL-SV.                                            *
-- ***************************************************************************************************************************
SELECT F.* FROM EMISOR_V3 F;
SELECT F.* FROM EMISOR_KCOO_V3 F;
SELECT F.* FROM EMISOR_ESTABLECIMIENTO_V3 F;

INSERT INTO EMISOR_ESTABLECIMIENTO_V3 (ID_EMISOR_ESTABLECIMIENTO,ID_EMISOR,ID_CAT_009,ID_CAT_012,ID_CAT_013,DIRECCION_COMPLEMENTO,TELEFONO,CODESTABLEMH,CODESTABLE,CODPUNTOVENTAMH,CODPUNTOVENTA,CORREO,NOMBENTREGA,DOCUENTREGA,NOMBRECIBE,DOCURECIBE,CORRELATIVO_CCF,CORRELATIVO_NC,CORRELATIVO_ND,CORRELATIVO_NR) 
VALUES (7,1,1,5,76,'Av. Albert Einstein y blvd Los Próceres, Urb. Lomas de San Francisco, # 1, Torre Cuscatlán, nivel 15, Antgo Cuscatlán, La Libertad.','25288000',null,'07',null,'733501','replegal-unosv@uno-terra.com','UNO EL SALVADOR','06140404600015','UNO EL SALVADOR','06140404600015',0,0,0,0);

COMMIT;

SELECT F.* FROM NOTIFIACION_CORREO_V3 F ORDER BY ID_NOTIFICACION;
SELECT F.* FROM NOTIFIACION_CORREO_V3 F WHERE F.ACTIVO=1 ORDER BY ID_NOTIFICACION;

UPDATE NOTIFIACION_CORREO_V3 SET ACTIVO=1 WHERE ID_NOTIFICACION IN (1,3,4,7,8,9,10);
UPDATE NOTIFIACION_CORREO_V3 SET ACTIVO=0 WHERE ID_NOTIFICACION > 0;
UPDATE NOTIFIACION_CORREO_V3 SET ACTIVO=1 WHERE ID_NOTIFICACION IN (3);
-- INSERT INTO NOTIFIACION_CORREO_V3 (ID_NOTIFICACION, CUENTA_CORREO, ACTIVO) VALUES (10, 'rasafacturacion@uno-terra.com', 0);
COMMIT;

-- ***************************************************************************************************************************
-- *          CONSULTA DE TABLA FEL JD EDWARDS FEL-SV.                                                                       *
-- ***************************************************************************************************************************
SELECT F.* FROM CRPDTA.F5542FEL@JDEPY F;
SELECT F.FEIVD, COUNT(*) NUMERO FROM CRPDTA.F5542FEL@JDEPY F GROUP BY F.FEIVD ORDER BY F.FEIVD;

SELECT F.FEKCOO, F.FEDOCO, F.FEDCTO, F.FEDOC, F.FEDCT, F.FEMCU, F.FEAN8, F.FESHAN, F.FECRCD, F.FESTCD, F.FEIVD, F.FECRSREF01, F.FECRSREF02, F.FECRSREF03, F.FECRSREF04, F.FECRSREF05, F.FEJEVER
FROM CRPDTA.F5542FEL@JDEPY F
WHERE F.FEDCTO='S3' AND F.FESTCD IN ('000','999');

SELECT F.FEKCOO, F.FEDOCO, F.FEDCTO, F.FEDOC, F.FEDCT, F.FEMCU, F.FEAN8, F.FESHAN, F.FECRCD, F.FESTCD, F.FEIVD, F.FECRSREF01, F.FECRSREF02, F.FECRSREF03, F.FECRSREF04, F.FECRSREF05, F.FEJEVER
FROM CRPDTA.F5542FEL@JDEPY F
WHERE F.FEDCTO='C3' AND F.FESTCD='000';

SELECT F.FEKCOO, F.FEDOCO, F.FEDCTO, F.FEDOC, F.FEDCT, F.FEMCU, F.FEAN8, F.FESHAN, F.FECRCD, F.FESTCD, F.FEIVD, F.FECRSREF01, F.FECRSREF02, F.FECRSREF03, F.FECRSREF04, F.FECRSREF05, F.FEJEVER
FROM CRPDTA.F5542FEL@JDEPY F
WHERE F.FEDCTO='SD' AND F.FESTCD='000';

UPDATE CRPDTA.F5542FEL@JDEPY SET FESTCD='000', FECRSREF01='-', FECRSREF02='-', FECRSREF03='-', FECRSREF04='-', FECRSREF05='-' WHERE FEDOCO IN (73305755);
COMMIT;

-- ***************************************************************************************************************************
-- *          COMPROBANTE DE CRÉDITO FISCAL.                                                                                 *
-- ***************************************************************************************************************************
SELECT F.* FROM DTE_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM IDENTIFICACION_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM DOCU_RELA_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RECEPTOR_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM SHIPTO_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM OTROS_DOCU_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM VENTA_TERCERO_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_DOCU_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_TRIBUTO_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_TRIBUTO_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM EXTENSION_CCF_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM APENDICE_CCF_V3 F ORDER BY F.ID_DTE DESC;

SELECT F.* FROM DTE_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM IDENTIFICACION_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM DOCU_RELA_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM RECEPTOR_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM SHIPTO_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM OTROS_DOCU_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM VENTA_TERCERO_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM CUERPO_DOCU_CCF_V3 F WHERE F.ID_DTE IN (180);
SELECT F.* FROM CUERPO_TRIBUTO_CCF_V3 F WHERE F.ID_DTE IN (180);
SELECT F.* FROM RESUMEN_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM RESUMEN_TRIBUTO_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM EXTENSION_CCF_V3 F WHERE F.ID_DTE IN (241);
SELECT F.* FROM APENDICE_CCF_V3 F WHERE F.ID_DTE IN (241);

-- ***************************************************************************************************************************
-- *          NOTA DE CRÉDITO.                                                                                               *
-- ***************************************************************************************************************************
SELECT F.* FROM DTE_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM IDENTIFICACION_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM DOCU_RELA_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RECEPTOR_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM SHIPTO_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM VENTA_TERCERO_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_DOCU_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_TRIBUTO_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_TRIBUTO_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM EXTENSION_NC_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM APENDICE_NC_V3 F ORDER BY F.ID_DTE DESC;

SELECT F.* FROM DTE_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM IDENTIFICACION_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM DOCU_RELA_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM RECEPTOR_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM SHIPTO_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM VENTA_TERCERO_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM CUERPO_DOCU_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM CUERPO_TRIBUTO_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM RESUMEN_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM RESUMEN_TRIBUTO_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM EXTENSION_NC_V3 F WHERE F.ID_DTE IN (25);
SELECT F.* FROM APENDICE_NC_V3 F WHERE F.ID_DTE IN (25);

-- ***************************************************************************************************************************
-- *          NOTA DE DÉBITO.                                                                                                *
-- ***************************************************************************************************************************
SELECT F.* FROM DTE_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM IDENTIFICACION_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM DOCU_RELA_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RECEPTOR_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM SHIPTO_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM VENTA_TERCERO_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_DOCU_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_TRIBUTO_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_TRIBUTO_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM EXTENSION_ND_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM APENDICE_ND_V3 F ORDER BY F.ID_DTE DESC;

SELECT F.* FROM DTE_ND_V3 F WHERE F.ID_DTE IN (63);
SELECT F.* FROM IDENTIFICACION_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM DOCU_RELA_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM RECEPTOR_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM SHIPTO_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM VENTA_TERCERO_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM CUERPO_DOCU_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM CUERPO_TRIBUTO_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM RESUMEN_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM RESUMEN_TRIBUTO_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM EXTENSION_ND_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM APENDICE_ND_V3 F WHERE F.ID_DTE IN (1);

-- ***************************************************************************************************************************
-- *          COMPROBANTE DE FACTURA.                                                                                 *
-- ***************************************************************************************************************************
SELECT F.* FROM DTE_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM IDENTIFICACION_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM DOCU_RELA_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RECEPTOR_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM SHIPTO_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM OTROS_DOCU_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM VENTA_TERCERO_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_DOCU_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM CUERPO_TRIBUTO_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM RESUMEN_TRIBUTO_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM EXTENSION_F_V3 F ORDER BY F.ID_DTE DESC;
SELECT F.* FROM APENDICE_F_V3 F ORDER BY F.ID_DTE DESC;

SELECT F.* FROM DTE_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM IDENTIFICACION_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM DOCU_RELA_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM RECEPTOR_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM SHIPTO_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM OTROS_DOCU_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM VENTA_TERCERO_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM CUERPO_DOCU_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM CUERPO_TRIBUTO_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM RESUMEN_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM RESUMEN_TRIBUTO_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM EXTENSION_F_V3 F WHERE F.ID_DTE IN (1);
SELECT F.* FROM APENDICE_F_V3 F WHERE F.ID_DTE IN (1);

-- ***************************************************************************************************************************
-- *          TABLAS FEL-GUATEMALA.                                                                                          *
-- ***************************************************************************************************************************
SELECT F.* FROM CRPDTA.F59421CA@JDEPY F;
SELECT F.* FROM CRPDTA.F59421DE@JDEPY F; -- ESTA TABLA NO SE PUEDE CONSULTAR A TRAVES DE DBLINK.
SELECT F.* FROM CRPDTA.F5942PAR@JDEPY F;

-- ***************************************************************************************************************************
-- *          QUERY PARA FECHAS JULIANAS Y GREGORIANAS.                                                                      *
-- ***************************************************************************************************************************
SELECT TO_NUMBER(SUBSTR(TO_CHAR(TO_DATE('04/01/2022','dd/MM/yyyy'),'ccYYddd'),2,6)) FECHA_JULIANA FROM DUAL;
SELECT TO_CHAR(TO_DATE(TO_CHAR(A.SDIVD + 1900000,'9999999'),'YYYYDDD'),'dd/MM/yyyy') FECHA_GREGORIANA FROM DUAL;
